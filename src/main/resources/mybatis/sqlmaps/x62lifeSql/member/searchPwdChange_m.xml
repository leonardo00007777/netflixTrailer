<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="searchPwdChange">
<!--    '프로젝트: 자연이랑 모바일 웹-->
<!--    '프로그램: 비밀번호 찾기 - 비밀번호 변경.-->

<!--    '20171012   sykim   처음작성-->
    <update id="updateNewPassword">
        /*updateNewPassword 새로운 비밀번호로 설정*/
        UPDATE mb_master
        SET mempw_hash = dbo.UBHASHFunc('SHA256',#{strNewPwd})
        WHERE memcd = #{strMemCd}
    </update>

    <update id="unlockAccount">
        /* unlockAccount 계정잠김 해제*/
        UPDATE logininfo
           SET islocked = 0
             , login_failed_count = 0
         WHERE memcd = #{strMemCd}
    </update>

    <update id="updateChangePasswordHistory">
        /* updateChangePasswordHistory 비밀번호 변경이력 업데이트*/
        UPDATE changefieldhistory
        SET date_mempw = GETDATE()
         WHERE memcd = #{strMemCd}
    </update>
</mapper>